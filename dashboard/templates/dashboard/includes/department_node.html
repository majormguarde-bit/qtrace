<div class="dept-wrapper {% if level == 0 %}dept-root{% endif %}">
    <div class="dept-node">
        <div class="dept-card">
            <div class="d-flex align-items-center">
                <div class="dept-icon me-3">
                    {% if level == 0 %}
                        <i class="bi bi-building text-primary fs-5"></i>
                    {% else %}
                        <i class="bi bi-folder2-open text-secondary"></i>
                    {% endif %}
                </div>
                <div>
                    <div class="fw-bold">{{ department.name }}</div>
                    {% if department.description %}
                        <div class="text-muted small">{{ department.description|truncatechars:50 }}</div>
                    {% endif %}
                </div>
            </div>
            <div class="dept-actions">
                <a href="{% url 'dashboard:department_edit' department.pk %}" class="btn btn-sm btn-light rounded-pill px-3 me-1">
                    <i class="bi bi-pencil small me-1"></i> Правка
                </a>
                <a href="{% url 'dashboard:department_delete' department.pk %}" class="btn btn-sm btn-light text-danger rounded-pill px-3">
                    <i class="bi bi-trash small me-1"></i> Удалить
                </a>
            </div>
        </div>

        {% with children=department.children.all %}
            {% if children %}
                <div class="mt-2">
                    {% for child in children %}
                        {% with department=child level=level|add:1 %}
                            {% include 'dashboard/includes/department_node.html' %}
                        {% endwith %}
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
    </div>
</div>
